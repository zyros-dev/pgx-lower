containers:
  dev:
    name: "pgx-lower-dev"
    port: 54320

  benchmark:
    name: "pgx-lower-benchmark"
    port: 54322

  host-profile:
    name: "host-native-profile"
    port: 54325

profiles:
  quick:
    runs:
      - container: benchmark
        scale_factor: 0.01
        iterations: 1
        profile: false
        heap: false

      - container: host-profile
        scale_factor: 0.01
        iterations: 1
        profile: true
        heap: true

      - container: dev
        scale_factor: 0.01
        iterations: 1
        profile: false
        heap: false

  full:
    runs:
      - container: benchmark
        scale_factor: 0.01
        iterations: 10
        profile: false
        heap: false

      - container: benchmark
        scale_factor: 0.02
        iterations: 3
        profile: false
        heap: false

      - container: benchmark
        scale_factor: 0.04
        iterations: 3
        profile: false
        heap: false

      - container: benchmark
        scale_factor: 0.08
        iterations: 3
        profile: false
        heap: false

      - container: benchmark
        scale_factor: 0.16
        iterations: 3
        profile: false
        heap: false

      - container: benchmark
        scale_factor: 0.32
        iterations: 3
        profile: false
        heap: false

      - container: benchmark
        scale_factor: 0.64
        iterations: 1
        profile: false
        heap: false

      - container: benchmark
        scale_factor: 1
        iterations: 1
        profile: false
        heap: false

      - container: host-profile
        scale_factor: 0.01
        iterations: 3
        profile: true
        heap: true

      - container: host-profile
        scale_factor: 0.1
        iterations: 1
        profile: true
        heap: false

environment:
  PYTHONUNBUFFERED: "1"

validation:
  check_containers: true
  check_postgres: true
  check_python_deps: true
