# ============================================================================
# Connection Settings
# ============================================================================
listen_addresses = '*'
port = 5433
max_connections = 100

# ============================================================================
# Memory Settings (optimized for 16GB+ systems)
# ============================================================================
# Shared buffers: PostgreSQL's main cache (25% of RAM)
shared_buffers = 4GB

# Working memory per operation (sorting, hash joins)
work_mem = 256MB

# Maintenance memory (VACUUM, CREATE INDEX)
maintenance_work_mem = 1GB

# Effective cache size hint (50-75% of total RAM)
effective_cache_size = 12GB

# ============================================================================
# Query Planner
# ============================================================================
# Cost parameters
random_page_cost = 1.1
effective_io_concurrency = 200

# JIT settings (we use our own JIT, but PostgreSQL's can interfere)
jit = off
jit_above_cost = -1
jit_inline_above_cost = -1
jit_optimize_above_cost = -1

# ============================================================================
# Write-Ahead Log (WAL)
# ============================================================================
wal_level = minimal
max_wal_senders = 0
fsync = off
synchronous_commit = off
full_page_writes = off

wal_buffers = 16MB

checkpoint_timeout = 1h
checkpoint_completion_target = 0.9
max_wal_size = 8GB

# ============================================================================
# Logging
# ============================================================================
log_destination = 'stderr'
logging_collector = off
log_statement = 'none'
log_duration = off
log_min_duration_statement = -1

log_checkpoints = on
log_autovacuum_min_duration = 0

# ============================================================================
# Autovacuum (reduced activity during benchmarks)
# ============================================================================
autovacuum = on
autovacuum_max_workers = 2
autovacuum_naptime = 1min

# ============================================================================
# Client Connection Defaults
# ============================================================================
shared_preload_libraries = ''    # Load pgx_lower dynamically per session

lc_messages = 'en_US.UTF-8'
lc_monetary = 'en_US.UTF-8'
lc_numeric = 'en_US.UTF-8'
lc_time = 'en_US.UTF-8'
default_text_search_config = 'pg_catalog.english'
