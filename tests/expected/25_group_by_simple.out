LOAD
'pgx_lower.so';
DROP TABLE IF EXISTS simple_group_by;
NOTICE:  table "simple_group_by" does not exist, skipping
CREATE TABLE simple_group_by
(
    id         SERIAL PRIMARY KEY,
    amount     INTEGER NOT NULL,
    quantity   INTEGER NOT NULL
);
INSERT INTO simple_group_by(amount, quantity)
VALUES (1200.00, 2),
       (25.50, 3),
       (85.75, 2),
       (29.99, 3),
       (49.99, 2),
       (300.00, 3),
       (89.99, 2),
       (15.99, 2),
       (125.00, 3),
       (450.00, 2);
SELECT quantity, COUNT(*) AS item_count
FROM simple_group_by
GROUP BY quantity;
NOTICE:  [PGX-LOWER] Routing through PGX_LOWER compilation
 quantity | item_count 
----------+------------
        2 |          6
        3 |          4
(2 rows)

SELECT quantity, COUNT(*) AS item_count
FROM simple_group_by
GROUP BY quantity
ORDER BY quantity;
NOTICE:  [PGX-LOWER] Routing through PGX_LOWER compilation
 quantity | item_count 
----------+------------
        2 |          6
        3 |          4
(2 rows)

SELECT quantity, COUNT(*) AS item_count
FROM simple_group_by
GROUP BY quantity
ORDER BY COUNT(*);
NOTICE:  [PGX-LOWER] Routing through PGX_LOWER compilation
 quantity | item_count 
----------+------------
        3 |          4
        2 |          6
(2 rows)

DROP TABLE IF EXISTS sales_data;
NOTICE:  table "sales_data" does not exist, skipping
CREATE TABLE sales_data
(
    id         SERIAL PRIMARY KEY,
    department VARCHAR(20),
    product    VARCHAR(30),
    amount     INTEGER,
    quantity   INTEGER
);
INSERT INTO sales_data(department, product, amount, quantity)
VALUES ('Electronics', 'Laptop', 1200, 2),
       ('Electronics', 'Mouse', 25, 10),
       ('Electronics', 'Keyboard', 85, 5),
       ('Clothing', 'Shirt', 29, 15),
       ('Clothing', 'Pants', 49, 8),
       ('Electronics', 'Monitor', 300, 3),
       ('Clothing', 'Shoes', 89, 6),
       ('Books', 'Novel', 15, 20),
       ('Books', 'Textbook', 125, 4),
       ('Electronics', 'Tablet', 450, 2);
SELECT department, COUNT(*) AS item_count
FROM sales_data
GROUP BY department;
NOTICE:  [PGX-LOWER] Routing through PGX_LOWER compilation
 department  | item_count 
-------------+------------
 Electronics |          5
 Clothing    |          3
 Books       |          2
(3 rows)

SELECT department, SUM(amount) AS total_sales
FROM sales_data
GROUP BY department
ORDER BY department;
NOTICE:  [PGX-LOWER] Routing through PGX_LOWER compilation
 department  | total_sales 
-------------+-------------
 Books       |         140
 Clothing    |         167
 Electronics |        2060
(3 rows)

SELECT department, AVG(amount) AS avg_amount
FROM sales_data
GROUP BY department
ORDER BY department;
NOTICE:  [PGX-LOWER] Routing through PGX_LOWER compilation
 department  | avg_amount 
-------------+------------
 Books       |         70
 Clothing    |  55.666666
 Electronics |        412
(3 rows)

SELECT department, MIN(amount) AS min_amount, MAX(amount) AS max_amount
FROM sales_data
GROUP BY department
ORDER BY department;
NOTICE:  [PGX-LOWER] Routing through PGX_LOWER compilation
 department  | min_amount | max_amount 
-------------+------------+------------
 Books       |         15 |        125
 Clothing    |         29 |         89
 Electronics |         25 |       1200
(3 rows)

SELECT department,
       COUNT(*)      AS item_count,
       SUM(amount)   AS total_sales,
       AVG(quantity) AS avg_quantity
FROM sales_data
GROUP BY department
ORDER BY department;
NOTICE:  [PGX-LOWER] Routing through PGX_LOWER compilation
 department  | item_count | total_sales | avg_quantity 
-------------+------------+-------------+--------------
 Books       |          2 |         140 |           12
 Clothing    |          3 |         167 |     9.666666
 Electronics |          5 |        2060 |          4.4
(3 rows)

DROP TABLE sales_data;
